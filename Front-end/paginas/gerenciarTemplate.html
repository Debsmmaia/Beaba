<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Gerenciar Template</title>
</head>
<body>

    <header id="cabecalho">
        <span onclick="openModalPerfil()" id="botaoPerfil">Nome usuário</span>
        <a href="logout.html" id="botSair">Sair</a>
    </header>

    <section id="botoes">
        <div>
            <img src="../imagens/sino.png" height="15px" id="notificacao" onclick="openModal()">
            <a href="Dashboard.html" class="links" id="botaoDash"  style="display: none;">Dashboard</a>
            <a href="gerenciarTemplate.html" class="links">Gerenciar Template</a>
            <a href="adicionarTemplate.html" class="links">Cadastrar Template</a>
            <a href="Uploads.html" class="links">Uploads</a>
            <a href="adicionarUsuario.html" class="links" id="botaoAdcUser"  style="display: none;">Adicionar Usuário</a> <br>
        </div>
    </section>

    <p id="linha"></p>

    <div class="modalContainer"> <!--Modal de notificações de todas as telas-->
        <div class="modal">
            <span class="titulo">Notificações</span>
            <button onclick="closeModal()" class="botaoX">X</button>
            <br>
            <div class="notificDiv">
                <span>O template nome foi aprovado! Já está disponível para uso. </span>
                <img src="../imagens/check.png" class="check">
            </div>
        </div>
    </div>

    <div class="modalContainerPerfil"> <!--Modal de perfil-->
        <div class="modalPerfil">
            <button onclick="closeModalPerfil()" class="botaoXPerfil">X</button>
            <span class="titulo">Deborah Maia</span> <br>
            <small>Administrador</small>
            <div id="divMudarSenha">
                <form id="mudarSenha">
                    <p id="tituloSenha">Trocar minha senha</p>
                    <label for="senhaAtual">Senha atual</label> <br>
                    <input type="text" class="camposMudarSenha"> <br>
                    <label for="senhaNova">Nova senha</label> <br>
                    <input type="text" class="camposMudarSenha"> <br>
                    <label for="senhaNovaConfirmacao">Confirmar nova senha</label> <br>
                    <input type="text" class="camposMudarSenha"> <br> <br>
                    <input type="submit" class="buttonMudarSenha">
                </form>
            </div>
        </div>
    </div>

    <div class="fundo" id="fundo"></div>

    <div class="modalContainerUpload"> <!--Modal da tela de  class Upload-->
        <div class="modalUpload">
            
            <span class="titulo">Fazer Upload</span> 
            <button onclick="closeModalUpload()" class="botaoXUpload">X</button> 
            <br> <br>
            <form>
                <div id="drop-area">
                    <p>Arraste e solte o arquivo aqui!</p>
                </div>
                <br>
                <div id="barra"></div>
                <div id="informacao"></div>
                <br>
                <input type="file" id="arquivo" name="arquivo" value="Pesquisar">
                <input type="submit" onclick="closeModalUpload()" id="botaoXUpload" class="botoesUpload" value="Adicionar">
            </form>
        </div>
    </div>
    
    <section>
        <span class="titulo">Gerenciar Templates</span> <br> <br>
        <div class="informacoesTemplate">
            <span >Nome do arquivo</span>
            <span class="rotulo">Formato</span>
            <span class="rotulo">Campos</span>
            <span class="rotulo">Solicitante</span>
        </div>
        <div id="containerTemplate">
            <div id="template">
                <span>Funcionários Cadastrados</span>
                <span>XLS</span>
                <span>5</span>
                <span>Deborah Maia</span>
                <div id="divBotoesTemplate">
                    <button class="botaoBranco">Download</button>
                    <button class="botaoBranco" id="botaoUpload" onclick="openModalUpload()">Upload</button> 
                    <label class="switch">
                        <input type="checkbox" id="toggle">
                        <span class="slider" id="botaoStatus" style="display: none;""></span>
                    </label>  
                </div> 
            </div>
        </div>
    </section>

    <script src="script.js"></script>

    <script>
        const userData = sessionStorage.getItem('userData');
        const userDataS = JSON.parse(userData);
        const tipo_perfil = userDataS.tipo_perfil;

        console.log(tipo_perfil);
    
        if (tipo_perfil === 'Administrador') {
            botaoDash.style.display = 'inline-block';
            botaoAdcUser.style.display = 'inline-block';
        } 

        if (tipo_perfil === 'Administrador') {
            botaoStatus.style.display = 'inline-block';
        } 

    </script>

    <script> 
        document.getElementById("toggle").addEventListener("click", function() {
        const status = document.querySelector(".status");
        status.textContent = this.checked ? "Habilitado" : "Desabilitado";});
    </script>

    <script>
        const dropArea = document.getElementById('drop-area');
        const progressBar = document.getElementById('barra');
        const fileInfo = document.getElementById('informacao');

        dropArea.addEventListener('dragover', (e) => {
            e.preventDefault();
        });

        dropArea.addEventListener('drop', (e) => {
            e.preventDefault();
            const file = e.dataTransfer.files[0];

            fileInfo.textContent = `Nome do arquivo: ${file.name}`;
            simulateFileUpload(file);
        });

        function simulateFileUpload(file) {

            const totalSize = file.size;
            let uploadedSize = 0;

            const uploadInterval = 200; 

            const uploadTimer = setInterval(() => {
                uploadedSize += 10000; 

                // Atualizar a barra de progresso
                const progress = (uploadedSize / totalSize) * 100;
                progressBar.style.width = progress + '%';

                if (uploadedSize >= totalSize) {
                    clearInterval(uploadTimer);
                }
            }, uploadInterval);
        }
    </script>

    <script src="script_senha.js"></script>
    
</body>
</html>