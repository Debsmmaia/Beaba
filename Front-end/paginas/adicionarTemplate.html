<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Cadastrar Template</title>
</head>

<body>

    <header id="cabecalho">
        <span onclick="openModalPerfil()" id="botaoPerfil">Nome usuário</span>
        <a href="logout.html" id="botSair">Sair</a>
    </header>

    <section id="botoes">
        <div>
            <img src="../imagens/sino.png" height="15px" id="notificacao" onclick="openModal()">
            <a href="Dashboard.html" class="links" id="botaoDash"  style="display: none;">Dashboard</a>
            <a href="gerenciarTemplate.html" class="links">Gerenciar Template</a>
            <a href="adicionarTemplate.html" class="links">Cadastrar Template</a>
            <a href="Uploads.html" class="links">Uploads</a>
            <a href="adicionarUsuario.html" class="links" id="botaoAdcUser"  style="display: none;">Adicionar Usuário</a> <br>
        </div>
    </section>

    <p id="linha"></p>

    <div class="modalContainer"> <!--Modal de notificações de todas as telas-->
        <div class="modal">
            <span class="titulo">Notificações</span>
            <button onclick="closeModal()" class="botaoX">X</button>
            <br>
            <div class="notificDiv">
                <span>O template nome foi aprovado! Já está disponível para uso. </span>
                <img src="../imagens/check.png" class="check">
            </div>
        </div>
    </div>

    <div class="modalContainerPerfil"> <!--Modal de perfil-->
        <div class="modalPerfil">
            <button onclick="closeModalPerfil()" class="botaoXPerfil">X</button>
            <span class="titulo">Deborah Maia</span> <br>
            <small>Administrador</small>
            <div id="divMudarSenha">
                <form id="mudarSenha">
                    <p id="tituloSenha">Trocar minha senha</p>
                    <label for="senhaAtual">Senha atual</label> <br>
                    <input type="text" class="camposMudarSenha"> <br>
                    <label for="senhaNova">Nova senha</label> <br>
                    <input type="text" class="camposMudarSenha"> <br>
                    <label for="senhaNovaConfirmacao">Confirmar nova senha</label> <br>
                    <input type="text" class="camposMudarSenha"> <br> <br>
                    <input type="submit" class="buttonMudarSenha">
                </form>
            </div>
        </div>
    </div>

    <div class="fundo" id="fundo"></div>

    <section id="sectionCadastroTemplate">
        <div id="divEsquerda">
            <p class="titulo">Adicionar Template</p> <br>
            <form id="adicionarTemplate">
                <label for="template">Nome do Template</label> <br>
                <input type="text" class="camposAdcTemplate" id="nomeTemplate"> <br>
                <label for="formato">Formato desejado</label> <br>
                <select id="formato" class="campoSelect">
                    <option>XLS</option>
                    <option>XLX</option>
                    <option>CSV</option>
                </select> <br>
                <label for="qtdCampos">Quantidade de campos desejados</label> <br>
                <input type="number" id="qtdCampos" class="camposAdcTemplate" min="1"> <br> <br>
                <input type="submit" id="adicionarCampos" value="Adicionar Template" class="botaoAdicionarTemplate">
            </form>
        </div>

        <div class="divDireita">
            <div id="divDireita">
                <p class="titulo" id="tituloCampos">Adicionar Campos</p> <br>
            </div>
            <button id="enviarForm" style="display: none;" class="botaoAdicionarTemplate2" style="float: bottom;">Enviar</button>
        </div>
    </section>

    <script src="script.js"></script>

    <script>
        const userData = sessionStorage.getItem('userData');
        const userDataS = JSON.parse(userData);
        const tipo_perfil = userDataS.tipo_perfil;

    
        if (tipo_perfil === 'Administrador') {
            botaoDash.style.display = 'inline-block';
            botaoAdcUser.style.display = 'inline-block';
        } 
    </script>

    <script>
        const qtdCampos = document.getElementById('qtdCampos');
        const camposAdicionados = document.getElementById('divDireita');
        const adicionarCampos = document.getElementById('adicionarCampos');

        adicionarCampos.addEventListener('click', function (event) {
            event.preventDefault();
            const quantidade = parseInt(qtdCampos.value);

            const camposAtuais = camposAdicionados.querySelectorAll('.divCampos');

            if (camposAtuais.length > quantidade) {
                for (let i = quantidade; i < camposAtuais.length; i++) {
                    camposAtuais[i].remove();
                }
            }

            for (let i = camposAtuais.length; i < quantidade; i++) {
                const novoCampo = document.createElement('div');
                const novoForm = document.createElement('form');

                const novoLabel = document.createElement('label');
                novoLabel.for = `Conteúdo do campo ${i + 1}`;
                novoLabel.innerText = `Conteúdo do campo ${i + 1}:`;

                const novoInput = document.createElement('input');
                novoInput.type = 'text';
                novoInput.name = `Campo${i + 1}`;
                novoInput.id = `Campo${i + 1}`;

                const novoLabelSelect = document.createElement('label');
                novoLabelSelect.for = `Tipo do dado - campo${i + 1}`;
                novoLabelSelect.innerText = `Tipo do dado - campo ${i + 1}:`;

                const novoSelect = document.createElement('select');
                novoSelect.name = `Tipo de dado${i + 1}`;
                novoSelect.id = `Tipo de dado${i + 1}`;
                const option1 = document.createElement('option');
                option1.value = 'Numero inteiro';
                option1.text = 'Numero inteiro';
                const option2 = document.createElement('option');
                option2.value = 'Palavra';
                option2.text = 'Palavra';
                const option3 = document.createElement('option');
                option3.value = 'Data';
                option3.text = 'Data';
                novoSelect.appendChild(option1);
                novoSelect.appendChild(option2);
                novoSelect.appendChild(option3);

                const novoLabelNulo = document.createElement('label');
                novoLabelNulo.for = `O campo ${i + 1} pode ser nulo?`;
                novoLabelNulo.innerText = `O campo ${i + 1} pode ser nulo?  `;

                const novoNulo = document.createElement('select');
                novoSelect.name = `O campo ${i + 1} pode ser nulo?`;
                novoSelect.id = `O campo ${i + 1} pode ser nulo?`;
                const option5 = document.createElement('option');
                option5.value = 'Sim';
                option5.text = 'Sim';
                const option6 = document.createElement('option');
                option6.value = 'Não';
                option6.text = 'Não';
                novoNulo.appendChild(option5);
                novoNulo.appendChild(option6);

                const lineBreak = document.createElement('br');
                novoInput.classList.add('camposAdcTemplate');
                novoSelect.classList.add('campoSelect');
                novoCampo.classList.add('divCampos');
                novoNulo.classList.add('camposNulo');
                novoForm.classList.add('camposTemplate')

                novoForm.appendChild(novoLabel);
                novoForm.appendChild(lineBreak);
                novoForm.appendChild(novoInput);
                novoForm.appendChild(lineBreak.cloneNode());
                novoForm.appendChild(novoLabelSelect);
                novoForm.appendChild(lineBreak.cloneNode());
                novoForm.appendChild(novoSelect);
                novoForm.appendChild(lineBreak.cloneNode());
                novoForm.appendChild(novoLabelNulo);
                novoForm.appendChild(novoNulo);
                novoForm.appendChild(lineBreak.cloneNode());
                novoForm.appendChild(lineBreak.cloneNode());
                novoForm.appendChild(lineBreak.cloneNode());

                // Adiciona o formulário com o campo ao novoCampo
                novoCampo.appendChild(novoForm);

                // Adiciona o novoCampo à divDireita
                camposAdicionados.appendChild(novoCampo);
            }

            // Verifica se a quantidade é maior que 0 para mostrar o botão de enviar
            if (quantidade > 0) {
                const botaoEnviar = document.getElementById('enviarForm');
                botaoEnviar.style.display = 'block';
            } else {
                const botaoEnviar = document.getElementById('enviarForm');
                botaoEnviar.style.display = 'none';
            }
        });
    </script>

    <script src="script_adcTemplate.js"></script>
    <script src="script_adcCampos.js"></script>

    <script src="script_senha.js"></script>

</body>

</html>